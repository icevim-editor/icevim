diff --git a/src/nvim/ex_docmd.c b/src/nvim/ex_docmd.c
index d692c3e10bd1e3..86c4ff6f9831da 100644
--- a/src/nvim/ex_docmd.c
+++ b/src/nvim/ex_docmd.c
@@ -4938,27 +4938,31 @@ static void ex_quitall(exarg_T *eap)
 /// ":restart +cmd <command>": restart the Nvim server using ":cmd" and add -c <command> to the new server.
 static void ex_restart(exarg_T *eap)
 {
-  // Patch v:argv to include "-c <arg>" when it restarts.
-  if (eap->arg != NULL) {
-    const list_T *l = get_vim_var_list(VV_ARGV);
-    int argc = tv_list_len(l);
-    list_T *argv_cpy = tv_list_alloc(argc + 2);
-    bool added_startup_arg = false;
-    TV_LIST_ITER_CONST(l, li, {
-      const char *arg = tv_get_string(TV_LIST_ITEM_TV(li));
-      size_t arg_size = strlen(arg);
-      assert(arg_size <= (size_t)SSIZE_MAX);
-      tv_list_append_string(argv_cpy, arg, (ssize_t)arg_size);
-      if (!added_startup_arg) {
-        tv_list_append_string(argv_cpy, "-c", 2);
-        size_t cmd_size = strlen(eap->arg);
-        assert(cmd_size <= (size_t)SSIZE_MAX);
-        tv_list_append_string(argv_cpy, eap->arg, (ssize_t)cmd_size);
-        added_startup_arg = true;
-      }
-    });
-    set_vim_var_list(VV_ARGV, argv_cpy);
-  }
+  const list_T *l = get_vim_var_list(VV_ARGV);
+  int argc = tv_list_len(l);
+  list_T *argv_cpy = tv_list_alloc(eap->arg ? argc + 2 : argc);
+  bool added_startup_arg = false;
+
+  TV_LIST_ITER_CONST(l, li, {
+    const char *arg = tv_get_string(TV_LIST_ITEM_TV(li));
+    size_t arg_size = strlen(arg);
+    assert(arg_size <= (size_t)SSIZE_MAX);
+    // Skip "-" argument (stdin input marker).
+    if (strequal(arg, "-")) {
+      continue;
+    }
+
+    tv_list_append_string(argv_cpy, arg, (ssize_t)arg_size);
+
+    // Patch v:argv to include "-c <arg>" when it restarts.
+    if (eap->arg && !added_startup_arg) {
+      tv_list_append_string(argv_cpy, "-c", 2);
+      tv_list_append_string(argv_cpy, eap->arg, (ssize_t)strlen(eap->arg));
+      added_startup_arg = true;
+    }
+  });
+
+  set_vim_var_list(VV_ARGV, argv_cpy);
 
   char *quit_cmd = (eap->do_ecmd_cmd) ? eap->do_ecmd_cmd : "qall";
   char *quit_cmd_copy = NULL;
diff --git a/test/functional/terminal/tui_spec.lua b/test/functional/terminal/tui_spec.lua
index 54e00d9319c8a9..a714ef1e89504b 100644
--- a/test/functional/terminal/tui_spec.lua
+++ b/test/functional/terminal/tui_spec.lua
@@ -440,6 +440,38 @@ describe('TUI :restart', function()
     restart_pid_check()
     gui_running_check()
   end)
+
+  it('filters stdin marker from v:argv on restart #34417', function()
+    if t.skip(is_os('win'), 'unstable on Windows') then
+      return
+    end
+    clear()
+    finally(function()
+      n.check_close()
+    end)
+    local screen = tt.setup_child_nvim({
+      '-u',
+      'NONE',
+      '-i',
+      'NONE',
+      '--cmd',
+      'set notermguicolors',
+      '-', -- stdin marker
+    })
+    tt.feed_data(':echo index(v:argv, "-") >= 0 ? v:true : v:false\013')
+    screen:expect({ any = 'v:true' })
+    tt.feed_data('\013')
+    tt.feed_data(':restart\013')
+    screen:expect([[
+      ^                                                  |
+      ~                                                 |*3
+      {2:[No Name]                       0,0-1          All}|
+                                                        |
+      {5:-- TERMINAL --}                                    |
+    ]])
+    tt.feed_data(':echo index(v:argv, "-") >= 0 ? v:true : v:false\013')
+    screen:expect({ any = 'v:false' })
+  end)
 end)
 
 describe('TUI :connect', function()
